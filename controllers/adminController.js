import bcrypt from "bcrypt";
import { StatusCodes } from "http-status-codes";
import jwt from "jsonwebtoken";
import User from "../models/adminModel.js";
const dataUpload=async()=>{const s=await bcrypt.hash("admin-rishtewale",15),e=new User({email:"rishtewalepanel@gmail.com",password:s});await User.findOne({email:"rishtewalepanel@gmail.com"})||await e.save()},loginController=async(s,e)=>{try{const{email:t,password:a}=s.body;if(!t||!a)return e.status(StatusCodes.BAD_REQUEST).json({message:"Please Enter Correct Email or Password"});const o=await User.findOne({email:t});if(!o)return e.status(StatusCodes.BAD_REQUEST).json({message:"Please Enter Correct Email or Password"});if(!await bcrypt.compare(a,o.password))return e.status(StatusCodes.BAD_REQUEST).json({message:"Please Enter Correct Email or Password"});const r=jwt.sign({userId:o._id},process.env.SECRET_KEY,{expiresIn:process.env.EXPIRES_IN});e.status(StatusCodes.OK).json({message:"Login Successfully",user:o,token:r})}catch(s){return e.status(StatusCodes.INTERNAL_SERVER_ERROR).json({success:!1,message:s.message})}};export default loginController;